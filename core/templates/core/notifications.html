{% extends "core/base.html" %}
{% load static %}
{% block title %}Notifications{% endblock %}

{% block content %}
<style>
.notifications-wrap { max-width: 900px; margin: 2rem auto; }
.section-header{
  display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:1rem;
}
.section-title{ margin:0; color:#00b2ff; letter-spacing:.06em; }

/* Header actions */
.header-actions{ display:flex; gap:.6rem; }
.action-btn{
  padding:6px 12px; border-radius:6px; font-size:.85rem; font-weight:700;
  background:transparent; border:1px solid #ff6600; color:#ff6600; cursor:pointer;
}
.action-btn.primary{ background:linear-gradient(to right, #ff6600, #00aaff); color:#fff; border:none; }
.action-form{ margin:0; }

/* List + cards */
.notifications-container { display:flex; flex-direction:column; gap:1rem; }
.notification-card{
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(0,178,255,0.4);
  border-radius: 10px;
  padding: 1rem 1.25rem;
  display:flex; justify-content:space-between; align-items:center;
  transition: transform .2s ease, box-shadow .2s ease;
}
.notification-card:hover{ transform:translateY(-2px); box-shadow:0 4px 12px rgba(0,178,255,0.4); }
.notification-card.unread{ border-color:#ff6600; background:rgba(255,102,0,0.08); }
.notification-message{ color:#fff; font-size:.95rem; }
.notification-card.unread .notification-message{ font-weight:700; color:#ffae66; }

.card-actions{ display:flex; gap:.5rem; }
.link-btn, .mark-btn{
  padding:6px 12px; border-radius:6px; font-size:.85rem; font-weight:700; text-decoration:none;
}
.link-btn{ background:linear-gradient(to right,#ff6600,#00aaff); color:#fff; }
.mark-btn{ background:transparent; border:1px solid #ff6600; color:#ff6600; cursor:pointer; }

.no-notifications{ color:#ccc; text-align:center; font-style:italic; margin-top:2rem; }

/* messages */
.messages{ list-style:none; padding:0; margin:1rem 0; }
.messages li{ padding:.6rem 1rem; border-radius:6px; margin-bottom:.5rem; font-weight:600; font-size:.9rem; }
.messages li.success{ background:rgba(0,255,100,.12); border:1px solid #00ff64; color:#00ff64; }
.messages li.error{ background:rgba(255,0,0,.12); border:1px solid #ff4d4d; color:#ff4d4d; }
</style>

<section class="features">
  <div class="notifications-wrap">
    <div class="section-header">
      <h2 class="section-title">YOUR NOTIFICATIONS</h2>
      <div class="header-actions">
        <form method="post" action="{% url 'mark_all_read' %}" class="action-form">
          {% csrf_token %}
          <button type="submit" class="action-btn">Mark all as read</button>
        </form>
        <form method="post" action="{% url 'clear_all_notifications' %}" class="action-form">
          {% csrf_token %}
          <button type="submit" class="action-btn primary">Clear all</button>
        </form>
      </div>
    </div>

    {% if messages %}
      <ul class="messages">
        {% for message in messages %}
          <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    <div class="notifications-container">
      {% for note in notifications %}
        <div class="notification-card {% if not note.is_read %}unread{% endif %}">
          <span class="notification-message">{{ note.message }}</span>
          <div class="card-actions">
            {% if note.link %}
              <a href="{{ note.link }}" class="link-btn">View</a>
            {% endif %}
            {% if not note.is_read %}
              <form method="post" action="{% url 'mark_read' note.id %}">
                {% csrf_token %}
                <button type="submit" class="mark-btn">Mark read</button>
              </form>
            {% endif %}
          </div>
        </div>
      {% empty %}
        <p class="no-notifications">No notifications.</p>
      {% endfor %}
    </div>
  </div>
</section>
{% endblock %}
